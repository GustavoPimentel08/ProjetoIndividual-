<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário - The G Method.</title>
    <link rel="stylesheet" href="./css/formulario.css">
    <link rel="shortcut icon" href="./fotos/favicon.png" type="image/x-icon">
</head>

<body onload="onloadEsconder()">

    <header id="header_lolo">
        <div class="container">
            <h2>Formulário</h2>
            <img class="foto-header" src="./fotos/apenas bandeiras.png" alt="Bandeiras">
        </div>
        <img class="bmw" src="./fotos/bmw.png" alt="Imagem BMW">
    </header>

    <section class="info_formulario" id="info_formulario">
        <div class="div_inicio" id="div_inicio">
            <h1>Seja Bem-vindo(a) ao site The G Method.</h1>
            <p class="p1">Agora você fará um formulário para descobrir qual o seu Perfil de Aprendizagem de Idiomas!</p>
            <p class="p1">Clique no botão iniciar para começar o formulário.</p>
            <p class="p2">Após finalizar, você será redirecionado para a Área de Membros.</p>
            <button class="btn btn1" id="btnIniciarQuiz" onclick="iniciarQuiz()">Iniciar</button>
        </div>
    </section>

    <section class="formulario_onepage" id="formulario_onepage" style="display: none;">
        <div class="central">
            <h1>Descubra seu perfil de aprendizagem!</h1>

            <div class="pergunta">
                <h2>1. Qual o seu Perfil de Aprendizagem de Idiomas?</h2>
                <p>Qual a melhor maneira de aprender um novo idioma para você?</p>
                <label><input type="radio" name="perfil" id="pergunta1_1" value="Visual"> Visual</label><br>
                <label><input type="radio" name="perfil" id="pergunta1_2" value="Auditivo"> Auditivo</label><br>
                <label><input type="radio" name="perfil" id="pergunta1_3" value="Leitura/Escrita">
                    Leitura/Escrita</label><br>
                <label><input type="radio" name="perfil" id="pergunta1_4" value="Cinestésico"> Cinestésico</label>

                <p class="explicacao"><strong>Visual:</strong> Pessoas com esse perfil aprendem melhor com
                    experiências visuais, assistindo series, desenhos, filmes. Aprendem "Assistindo coisas".</p><br>
                <p class="explicacao"><strong>Auditivo:</strong> Pessoas com esse perfil aprendem melhor com
                    experiências auditivas, escutando músicas, pod cast's ou até pessoas tendo dialógos. Aprendem
                    "Escutando".</p><br>
                <p class="explicacao"><strong>Leitura/Escrita:</strong> Pessoas com esse perfil aprendem melhor com
                    experiências de leitura, com livros físicos ou digitais e também preferem aprender escrevendo.
                    Aprendem "Lendo/Escrevendo".</p><br>
                <p class="explicacao"><strong>Cinestésico:</strong> Pessoas com esse perfil aprendem melhor com
                    experiências práticas, movimentos e interação física. Aprendem "fazendo".</p>

            </div>

            <div class="pergunta">
                <h2>2. Quais dos 5 pilares da fluência você acha mais desafiador?</h2>
                <p>Você pode escolher até duas opções:</p>
                <label><input type="checkbox" name="pilares" id="pergunta2_1" value="Fala - Speaking"> • Fala - Speaking</label><br>
                <label><input type="checkbox" name="pilares" id="pergunta2_2" value="Audição - listening"> • Audição - listening</label><br>
                <label><input type="checkbox" name="pilares" id="pergunta2_3" value="Leitura - Reading"> • Leitura - Reading</label><br>
                <label><input type="checkbox" name="pilares" id="pergunta2_4" value="Escrita - Writing"> • Escrita - Writing</label><br>
                <label><input type="checkbox" name="pilares" id="pergunta2_5" value="Interpretação - Interpretation"> • Interpretação - Interpretation</label><br>

                <label for="justificativa">
                    <p>Justifique sua resposta:</p>
                </label>
                <textarea id="justificativa" rows="4" cols="50" placeholder="Digite aqui..." class="input1"></textarea>
            </div>

            <div class="pergunta">
                <h2>3. Como você prefere estudar um novo idioma?</h2>
                <label><input type="radio" name="estudo" id="pergunta3_1" value="Em grupo"> Em grupo</label><br>
                <label><input type="radio" name="estudo" id="pergunta3_2" value="Sozinho(a)"> Sozinho(a)</label><br>
                <label><input type="radio" name="estudo" id="pergunta3_3" value="Não tenho base"> Nunca estudei nenhum
                    além
                    do meu idioma nativo</label><br>
            </div>

            <button class="btn btn1" onclick="enviarRespostas()">Enviar Respostas</button>

        </div>
    </section>

    <script>
        var pergunta1 = ""; // pode ser var normal
        var pergunta2 = [];
        var pergunta3 = ''; // pode ser var normal

        var questao1_1 = document.getElementById("pergunta1_1");
        var questao1_2 = document.getElementById("pergunta1_2");
        var questao1_3 = document.getElementById("pergunta1_3");
        var questao1_4 = document.getElementById("pergunta1_4");;

        var questao2_1 = pergunta2_1.value;
        var questao2_2 = pergunta2_2.value;
        var questao2_3 = pergunta2_3.value;
        var questao2_4 = pergunta2_4.value;
        var questao2_5 = pergunta2_5.value;

        var questao3_1 = pergunta3_1.value;
        var questao3_2 = pergunta3_2.value;
        var questao3_3 = pergunta3_3.value;


        function onloadEsconder() {
            document.getElementById('info_formulario').style.display = "flex";
            document.getElementById('formulario_onepage').style.display = "none";
        }

        function iniciarQuiz() {
            document.getElementById('info_formulario').style.display = "none";
            document.getElementById('formulario_onepage').style.display = "flex";
        }


        function enviarRespostas() {

        var questao1_1 = document.getElementById("pergunta1_1");
        var questao1_2 = document.getElementById("pergunta1_2");
        var questao1_3 = document.getElementById("pergunta1_3");
        var questao1_4 = document.getElementById("pergunta1_4");

        var questao2_1 = document.getElementById('pergunta2_1');
        var questao2_2 = document.getElementById('pergunta2_2');
        var questao2_3 = document.getElementById('pergunta2_3');
        var questao2_4 = document.getElementById('pergunta2_4');
        var questao2_5 = document.getElementById('pergunta2_5');

        var questao3_1 = document.getElementById('pergunta3_1');
        var questao3_2 = document.getElementById('pergunta3_2');
        var questao3_3 = document.getElementById('pergunta3_3');

            //Pergunta 1 - Vai adicionar na lista para ir para o BD
            if (questao1_1.checked) {
                pergunta1 = (pergunta1_1.value)
            }
            if (questao1_2.checked) {
                pergunta1 = (pergunta1_2.value)
            }
            if (questao1_3.checked) {
                pergunta1 = (pergunta1_3.value)
            }
            if (questao1_4.checked) {
                pergunta1 = (pergunta1_4.value)
            }

            //Pergunta 2 - Vai adicionar na lista para ir para o BD
            if (questao2_1.checked) {
                pergunta2.push(pergunta2_1.value)
            }
            if (questao2_2.checked) {
                pergunta2.push(pergunta2_2.value)
            }
            if (questao2_3.checked) {
                pergunta2.push(pergunta2_3.value)
            }
            if (questao2_4.checked) {
                pergunta2.push(pergunta2_4.value)
            }
            if (questao2_5.checked) {
                pergunta2.push(pergunta2_5.value)
            }

            //Pergunta 3 - Vai adicionar na lista para ir para o BD
            if (questao3_1.checked) {
                pergunta3 = pergunta3_1.value;
            }
            if (questao3_2.checked) {
                pergunta3 = pergunta3_2.value;
            }
            if (questao3_3.checked) {
                pergunta3 = pergunta3_3.value;
            }

            var ID_USUARIO = sessionStorage.ID_USUARIO;

            fetch("/formulario/inserir", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    // crie um atributo que recebe o valor recuperado aqui
                    // Agora vá para o arquivo routes/usuario.js
                    pergunta1Server: pergunta1,
                    pergunta2Server: pergunta2,
                    pergunta3Server: pergunta3,
                    id_usuarioServer: ID_USUARIO
                    // idEmpresaVincularServer: idEmpresaVincular
                }),
            })
                .then(function (resposta) { // retorno das informaçoes 
                    console.log("resposta: ", resposta);

                    if (resposta.ok) {

                        mensagem_erro.innerHTML =
                            "Inserção realizada com sucesso! Redirecionando para Area de membros...";
                        console.log("Pergunta1; ", pergunta1);
                        console.log("Pergunta1; ", pergunta2);
                        console.log("Pergunta1; ", pergunta3);
                        
                    resposta.json().then(json =>{
                        sessionStorage.ID_FORMULARIO = json.idFormulario;
                        console.log(sessionStorage.ID_FORMULARIO)
                        console.log(sessionStorage.ID_FORMULARIO)
                    })
                    } else {
                        throw "Houve um erro ao tentar realizar a inserção! / SOS";
                    }
                })
                .catch(function (resposta) {
                    console.log(`#ERRO: ${resposta}`);
                });

            alert("Respostas enviadas com sucesso!");
            // window.location.href = "./login.html";
        }

    </script>
</body>

</html>